<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Pledge Taxes Calculator</title>
    <meta property="og:title" content="Pledge taxes calculator" />
    <meta property="og:description" content="Sell vs donate, exercise vs wait, ISO vs NSO, and tax implications in one simplified chart." />
    <meta property="og:image" content="https://pledge-calculator.onrender.com/screenshot.png" />
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="donation-calculator-favicon.svg">
  </head>
  <body>
    <div id="root">
      <div class="App">
        <h1>Pledge Taxes Calculator</h1>
        
        <div style="margin-bottom: 30px;">
          <!-- Tax Rates Section -->
          <h2>Tax Rates</h2>
          
          <div class="field-container">
            <div class="label-container">
              <label style="font-weight: 500;">Income tax</label>
              <div class="description">
                Also, short term capital gains tax <a href="#notes" style="color: inherit; text-decoration: none;">[1]</a>. 
                If you're calculating this at home, remember to include payroll taxes for income, and NIIT for capital gains.
                <br> Includes both federal and state (California).
              </div>
            </div>
            <div class="input-group">
              <input 
                type="text" 
                id="incomeTaxRate"
                value="50"
              />
              <span style="margin-left: 5px;">%</span>
            </div>
          </div>
          
          <div class="field-container">
            <div class="label-container">
              <label style="font-weight: 500;">Long term capital gains tax (ltcg)</label>
              <div class="description">
                Remember to include NIIT. Include both federal and state.
              </div>
            </div>
            <div class="input-group">
              <input 
                type="text" 
                id="ltcgRate"
                value="35"
              />
              <span style="margin-left: 5px;">%</span>
            </div>
          </div>
          
          <!-- Stock Prices Section -->
          <h2>Stock Prices</h2>
          
          <div class="field-container">
            <div class="label-container">
              <label style="font-weight: 500;">Strike price</label>
              <div class="description">
                The 409a valuation at the time your grant was issued.
              </div>
            </div>
            <div class="input-group">
              <span style="margin-right: 5px;">$</span>
              <input 
                type="text" 
                id="strikePrice"
                value="10"
              />
            </div>
          </div>
          
          <div class="field-container">
            <div class="label-container">
              <label style="font-weight: 500;">Exercise price</label>
              <div class="description">
                The 409a valuation at the time of exercise (which is at least 1 year after your grant started).
              </div>
            </div>
            <div class="input-group">
              <span style="margin-right: 5px;">$</span>
              <input 
                type="text" 
                id="exercisePrice"
                value="20"
              />
            </div>
          </div>
          
          <div class="field-container">
            <div class="label-container">
              <label style="font-weight: 500;">Sale price</label>
              <div class="description">
                The 409a valuation at the time of the liquidity event.
              </div>
            </div>
            <div class="input-group">
              <span style="margin-right: 5px;">$</span>
              <input 
                type="text" 
                id="salePrice"
                value="60"
              />
            </div>
          </div>
          
          <!-- Warning Section -->
          <div id="price-warning"></div>
          
          <!-- Results Section -->
          <h2>Calculated Results</h2>
          <div id="results" style="margin-bottom: 30px;">
            Calculating...
          </div>
        </div>
        
        <hr>

        <!-- Options Comparison Table -->
        <div style="margin-bottom: 30px;">
          <h2>Stock Options: Compare Your Options</h2>
          
          
          <div class="field-container" style="margin-bottom: 20px;">
            <div class="label-container">
              <label style="font-weight: 500;">Match</label>
            </div>
            <div class="input-group" style="display: flex; gap: 15px; width: auto;">
              <label style="display: flex; align-items: center; gap: 4px;">
                <input type="radio" name="match" value="none" checked> None
              </label>
              <label style="display: flex; align-items: center; gap: 4px;">
                <input type="radio" name="match" value="1:1"> 1:1
              </label>
              <label style="display: flex; align-items: center; gap: 4px;">
                <input type="radio" name="match" value="3:1"> 3:1
              </label>
            </div>
          </div>
          
          <div class="grid-table-container">
            <div class="grid-table">
              <!-- Table Header -->
              <div class="grid-header">Option type</div>
              <div class="grid-header">Holding period</div>
              <div class="grid-header">Disposal Method</div>
              <div class="grid-header">Government gets</div>
              <div class="grid-header">Charity gets <a href="#notes" style="color: inherit; text-decoration: none;">[2]</a></div>
              <div class="grid-header">You get in cash</div>
              <div class="grid-header">You get via tax deduction <a href="#notes" style="color: inherit; text-decoration: none;">[3]</a></div>
              <div class="grid-header"># of shares</div>
              
              <!-- Row 1 -->
              <div class="grid-cell">ISO or NSO</div>
              <div class="grid-cell">Cashless exercise during liquidity</div>
              <div class="grid-cell">Sell</div>
              <div class="grid-cell">income tax * sprain</div>
              <div class="grid-cell"></div>
              <div class="grid-cell">(1 - income tax) * sprain</div>
              <div class="grid-cell"></div>
              <div class="grid-cell"><input type="text" value="0" class="shares-input"></div>
              
              <!-- Row 2 -->
              <div class="grid-cell">ISO or NSO</div>
              <div class="grid-cell">Cashless exercise during liquidity</div>
              <div class="grid-cell">Donate</div>
              <div class="grid-cell">income tax * sprain</div>
              <div class="grid-cell">(1 - income tax) * sprain * (1 + match)</div>
              <div class="grid-cell"></div>
              <div class="grid-cell">(1 - income tax) * sprain * income tax</div>
              <div class="grid-cell"><input type="text" value="0" class="shares-input"></div>
              
              <!-- Row 3 -->
              <div class="grid-cell">ISO or NSO</div>
              <div class="grid-cell">Dispose &lt;1 yr after exercise</div>
              <div class="grid-cell">Sell</div>
              <div class="grid-cell">income tax * sprain</div>
              <div class="grid-cell"></div>
              <div class="grid-cell">(1 - income tax) * sprain</div>
              <div class="grid-cell"></div>
              <div class="grid-cell"><input type="text" value="0" class="shares-input"></div>
              
              <!-- Row 4 -->
              <div class="grid-cell">ISO or NSO</div>
              <div class="grid-cell">Dispose &lt;1 yr after exercise</div>
              <div class="grid-cell">Donate</div>
              <div class="grid-cell">income tax * sprain</div>
              <div class="grid-cell">sale price * (1 + match)</div>
              <div class="grid-cell">- strike price - income tax * sprain</div>
              <div class="grid-cell">exercise price * income tax</div>
              <div class="grid-cell"><input type="text" value="0" class="shares-input"></div>
              
              <!-- Row 5 - ISO Sell -->
              <div class="grid-cell">ISO</div>
              <div class="grid-cell">Dispose 1+ yr after exercise</div>
              <div class="grid-cell">Sell</div>
              <div class="grid-cell">ltcg * sprain</div>
              <div class="grid-cell"></div>
              <div class="grid-cell">(1 - ltcg) * sprain</div>
              <div class="grid-cell"></div>
              <div class="grid-cell"><input type="text" value="0" class="shares-input"></div>
              
              <!-- Row 6 - ISO Donate -->
              <div class="grid-cell">ISO</div>
              <div class="grid-cell">Dispose 1+ yr after exercise</div>
              <div class="grid-cell">Donate</div>
              <div class="grid-cell">amt * spread <a href="#notes" style="color: inherit; text-decoration: none;">[4]</a></div>
              <div class="grid-cell">sale price * (1 + match)</div>
              <div class="grid-cell">- strike price</div>
              <div class="grid-cell">sale price * income tax</div>
              <div class="grid-cell"><input type="text" value="0" class="shares-input"></div>
              
              <!-- Row 7 - NSO Sell -->
              <div class="grid-cell">NSO</div>
              <div class="grid-cell">Dispose 1+ yr after exercise</div>
              <div class="grid-cell">Sell</div>
              <div class="grid-cell">income tax * spread + ltcg * gain</div>
              <div class="grid-cell"></div>
              <div class="grid-cell">(1 - income tax) * spread + (1 - ltcg) * gain</div>
              <div class="grid-cell"></div>
              <div class="grid-cell"><input type="text" value="0" class="shares-input"></div>
              
              <!-- Row 8 - NSO Donate -->
              <div class="grid-cell">NSO</div>
              <div class="grid-cell">Dispose 1+ yr after exercise</div>
              <div class="grid-cell">Donate</div>
              <div class="grid-cell">income tax * spread</div>
              <div class="grid-cell">sale price * (1 + match)</div>
              <div class="grid-cell">- strike price - income tax * spread</div>
              <div class="grid-cell">sale price * income tax</div>
              <div class="grid-cell"><input type="text" value="0" class="shares-input"></div>
              
              <!-- Row 9 - RSU Sell -->
              <div class="grid-cell">RSU</div>
              <div class="grid-cell">Any</div>
              <div class="grid-cell">Sell</div>
              <div class="grid-cell">income tax * sale price</div>
              <div class="grid-cell"></div>
              <div class="grid-cell">(1 - income tax) * sale price</div>
              <div class="grid-cell"></div>
              <div class="grid-cell"><input type="text" value="0" class="shares-input"></div>
              
              <!-- Totals Row -->
              <div class="grid-cell totals-cell">Totals</div>
              <div class="grid-cell totals-cell"></div>
              <div class="grid-cell totals-cell"></div>
              <div class="grid-cell totals-cell" id="total-gov"></div>
              <div class="grid-cell totals-cell" id="total-charity"></div>
              <div class="grid-cell totals-cell" id="total-cash"></div>
              <div class="grid-cell totals-cell" id="total-deduction"></div>
              <div class="grid-cell totals-cell" id="total-shares"></div>
            </div>
            
            <!-- Summary Lines - Outside Grid -->
            <div style="display: flex; flex-direction: column; margin-top: 20px; margin-left: auto; width: 100%; max-width: 600px; align-items: flex-end;">
              <div style="display: flex; margin-bottom: 8px; justify-content: flex-end;">
                <div style="font-weight: 500; font-size: 0.95rem; text-align: right; margin-right: 4px;">Total to charity:</div>
                <div id="total-to-charity" style="font-weight: 500; font-size: 0.95rem; width: 100px; text-align: right;"></div>
              </div>
              <div style="display: flex; justify-content: flex-end;">
                <div style="font-weight: 500; font-size: 0.95rem; text-align: right; margin-right: 4px;">Total to you (cash + deduction):</div>
                <div id="total-to-you" style="font-weight: 500; font-size: 0.95rem; width: 100px; text-align: right;"></div>
              </div>
            </div>
          </div>
        </div>
        
        <hr>
        
        <!-- Notes Section -->
        <div id="notes" style="margin-top: 40px; margin-bottom: 30px;">
          <div style="max-width: 600px;">
            <!-- Tax deduction limitations Section -->
            <div class="collapsible-section" style="margin-bottom: 24px;">
              <h3 style="font-size: 1.1rem; color: #555; margin-bottom: 8px; cursor: pointer; display: flex; align-items: center;" onclick="toggleSection('deduction-limits-section')">
                <span id="deduction-limits-toggle" style="margin-right: 8px; font-size: 0.8em; width: 12px;">&#9660;</span>
                Tax deduction limitations
              </h3>
              <div id="deduction-limits-section" style="display: block; margin-top: 16px;">
                <p style="font-size: 0.85rem; margin-bottom: 12px;">
                  The IRS implements tax deductions by reducing your taxable income. In all cases, this means your tax deductions are limited by the total taxes you pay, but for donations, the IRS has stricter limits than that.
                </p>
                
                <p style="font-size: 0.85rem; margin-bottom: 12px;">
                  There are two important things to know:
                </p>
                <ul style="font-size: 0.85rem; padding-left: 20px; margin-bottom: 16px;">
                  <li>The maximum tax deduction you can get, given your income</li>
                  <li>The minimum amount of planning you need to do to get that deduction</li>
                </ul>
                
                <p style="font-size: 0.85rem; margin-bottom: 12px;">
                  For bullet 1, here is a graph of the max tax deduction, using the share numbers above. The x-axis is the total (household) income you expect over the next 10 years, not including income you get from exercising or selling company shares. Include both wage income and investment income.
                </p>
                
                <div style="width: 100%; max-width: 600px; height: 300px; margin-bottom: 20px;">
                  <canvas id="deduction-graph" width="600" height="300"></canvas>
                </div>
                
                <p style="font-size: 0.85rem; margin-bottom: 12px;">
                  DAFs are "50% limit organizations", in the parlance of the IRS. 50% limit organizations have the following tax deduction limits:
                </p>
                
                <table style="font-size: 0.85rem; margin-bottom: 16px; border-collapse: collapse; width: 100%;">
                  <thead>
                    <tr>
                      <th style="padding: 10px 8px; border: 1px solid #ddd; background-color: #f0f0f0; text-align: left; font-weight: 600; font-size: 0.85rem;">Holding period</th>
                      <th style="padding: 10px 8px; border: 1px solid #ddd; background-color: #f0f0f0; text-align: left; font-weight: 600; font-size: 0.85rem;">Annual deduction limit, as a % of income</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td style="padding: 6px 10px; border: 1px solid #ddd;">Cashless exercise during liquidity</td>
                      <td style="padding: 6px 10px; border: 1px solid #ddd;">50% <a href="#footnotes" style="color: inherit; text-decoration: none;">[a]</a></td>
                    </tr>
                    <tr>
                      <td style="padding: 6px 10px; border: 1px solid #ddd;">Dispose &lt;1 yr after exercise</td>
                      <td style="padding: 6px 10px; border: 1px solid #ddd;">50%</td>
                    </tr>
                    <tr>
                      <td style="padding: 6px 10px; border: 1px solid #ddd;">Dispose 1+ yr after exercise</td>
                      <td style="padding: 6px 10px; border: 1px solid #ddd;">30% if using sale price, or 50% if using cost basis <a href="#footnotes" style="color: inherit; text-decoration: none;">[b]</a></td>
                    </tr>
                  </tbody>
                </table>
                
                <p style="font-size: 0.85rem; margin-bottom: 12px;">
                  Extra donations carry forward for 5 years. So if you make $100k/yr, and donate in cash, you can donate $300k in year 1 (50% * 100k * 6 years), and have it all (eventually) be deducted.
                </p>
                
                <p style="font-size: 0.85rem; margin-bottom: 12px;">
                  <span style="display: inline-block; min-width: 20px; font-weight: 500;">[a]</span>
                  It's actually 60% federally for 2025 (still 50% for California).
                </p>
                
                <p style="font-size: 0.85rem; margin-bottom: 12px;">
                  <span style="display: inline-block; min-width: 20px; font-weight: 500;">[b]</span>
                  See "The cost basis method for NSOs and ISOs" below. For now, and unless otherwise stated, assume we're using the 30% method.
                </p>
                
                <h4 style="font-size: 0.95rem; color: #555; margin-top: 20px; margin-bottom: 12px;">Doing the computation</h4>
                
                <p style="font-size: 0.85rem; margin-bottom: 12px;">
                  We'll use the inputs from "Stock Options: Compare Your Options" above, along with the following notation:
                </p>
                
                <ul style="font-size: 0.85rem; padding-left: 20px; margin-bottom: 16px;">
                  <li>D: number of donated shares</li>
                  <li>S: number of sold shares</li>
                  <li>DS: number of shares donated or sold (D + S)</li>
                  <li>Cashless: Cashless exercise during liquidity</li>
                  <li>Long: disposed 1+ yr after exercise</li>
                  <li>Short: disposed &lt;1 yr after exercise</li>
                </ul>
                                
                <table style="font-size: 0.85rem; margin-bottom: 16px; border-collapse: collapse; width: 100%;" id="computation-table">
                  <thead>
                    <tr>
                      <th style="padding: 10px 8px; border: 1px solid #ddd; background-color: #f0f0f0; text-align: left; font-weight: 600; font-size: 0.85rem; width: 5%;"></th>
                      <th style="padding: 10px 8px; border: 1px solid #ddd; background-color: #f0f0f0; text-align: left; font-weight: 600; font-size: 0.85rem; width: 45%;">Computation step</th>
                      <th style="padding: 10px 8px; border: 1px solid #ddd; background-color: #f0f0f0; text-align: left; font-weight: 600; font-size: 0.85rem; width: 50%;">Result</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td style="padding: 6px 10px; border: 1px solid #ddd; width: 5%;">1</td>
                      <td style="padding: 6px 10px; border: 1px solid #ddd; width: 45%;">Deductions subject to 30% limit</td>
                      <td style="padding: 6px 10px; border: 1px solid #ddd; width: 50%;" data-formula="Long D * sale price">
                        <div style="font-size: 0.7rem; color: #666; margin-bottom: 4px;">Long D * sale price</div>
                        <div style="font-weight: 500; color: #333; padding-left: 8px;" id="calc-row1"></div>
                      </td>
                    </tr>
                    <tr>
                      <td style="padding: 6px 10px; border: 1px solid #ddd;">2</td>
                      <td style="padding: 6px 10px; border: 1px solid #ddd;">Deductions subject to 50% limit</td>
                      <td style="padding: 6px 10px; border: 1px solid #ddd;" data-formula="Cashless D * (1 - income tax) * sprain + Short D * exercise price">
                        <div style="font-size: 0.7rem; color: #666; margin-bottom: 4px;">Cashless D * (1 - income tax) * sprain +<br>Short D * exercise price</div>
                        <div style="font-weight: 500; color: #333; padding-left: 8px;" id="calc-row2"></div>
                      </td>
                    </tr>
                    <tr>
                      <td style="padding: 6px 10px; border: 1px solid #ddd;">3</td>
                      <td style="padding: 6px 10px; border: 1px solid #ddd;">Income generated from exercise and sale of options</td>
                      <td style="padding: 6px 10px; border: 1px solid #ddd;" data-formula="(Cashless DS + Short DS + Long S) * sprain + NSO D * spread + RSU * sale price">
                        <div style="font-size: 0.7rem; color: #666; margin-bottom: 4px;">(Cashless DS + Short DS + Long S) * sprain +<br>NSO D * spread + RSU * sale price</div>
                        <div style="font-weight: 500; color: #333; padding-left: 8px;" id="calc-row3"></div>
                      </td>
                    </tr>
                    <tr>
                      <td style="padding: 8px 10px; border: 1px solid #ddd; background-color: #f0f0f0; font-weight: 600; border-top: 2px solid #ccc;">4</td>
                      <td style="padding: 8px 10px; border: 1px solid #ddd; background-color: #f0f0f0; border-top: 2px solid #ccc;">Add'l wage/investment income needed (over 10+ years) to fully deduct</td>
                      <td style="padding: 8px 10px; border: 1px solid #ddd; background-color: #f0f0f0; border-top: 2px solid #ccc;" data-formula="max(100/30 * row1, 2 * (row1 + row2)) - row3">
                        <div style="font-size: 0.7rem; color: #666; margin-bottom: 4px;">max(100/30 * row1, 2 * (row1 + row2)) - row3</div>
                        <div style="font-weight: 500; color: #333; padding-left: 8px;" id="calc-row4"></div>
                      </td>
                    </tr>
                  </tbody>
                </table>
                
                <h4 style="font-size: 0.95rem; color: #555; margin-top: 24px; margin-bottom: 12px;">Discussion</h4>
                <p style="font-size: 0.85rem; margin-bottom: 12px;">
                  I think the right way to think about the number above is "how complicated of a scheme do I need to fully realize the tax deduction"? Some possible schemes, in increasing complexity:
                </p>
                <ul style="font-size: 0.85rem; padding-left: 20px; margin-bottom: 24px;">
                  <li>Assume it'll work out. If Row1 + Row2 is less than your annual household income, this is likely to be the case.</li>
                  <li>Any time you sell, also donate at least your pledge %age in that calendar year. If you're mostly cashless exercising, or have a pledge %age much less than 50%, this is likely to work.</li>
                  <li>Start the clock right away. Starting Fall 2025, just saturate your 30% and 50% buckets each year, with no further planning.</li>
                  <li>Ditto, but also expect to fully utilize the "you have 3 years post-liquidity to make the donation" provision to postpone donations on the other end [c].</li>
                  <li>Switch to the cost basis method for your NSOs, and possibly your ISOs. Likely relevant in worlds where the company does extremely well, and you have a lot of Long D.</li>
                </ul>

                <p style="font-size: 0.85rem; margin-bottom: 12px;">
                  Once you're in the last bullet, you're no longer getting the full tax deduction, and the calculation in the Stock Options table is no longer correct. 
                  The tax deduction benefit should instead be something like "(row3 + expected add'l income) * (30 to 50%) * income tax".
                </p>

                <p style="font-size: 0.85rem; margin-bottom: 12px;">
                  <span style="display: inline-block; min-width: 20px; font-weight: 500;">[c]</span>
                  One implementation technicality: you always have to use the current year's donations before you can dip into your carryover, even if the carryover is about to expire. In the extreme case, let's say you make a 10x-your-income donation in year 1. You will need to delay any further donations till year 7 to get a deduction benefit for them.
                </p>
                
                <h4 style="font-size: 0.95rem; color: #555; margin-top: 24px; margin-bottom: 12px;">The cost basis method for NSOs and ISOs (advanced)</h4>
                <p style="font-size: 0.85rem; margin-bottom: 12px;">
                  This is only relevant if you're in the last bullet from the Discussion section.
                </p>
                <p style="font-size: 0.85rem; margin-bottom: 12px;">
                  If you expect to fully saturate your 30% deductions, but not your 50% deductions, you can elect to have your Long Ds fall under the 50% limit. Here are the deductible 
                  amounts under each limit:
                </p>
                
                <table style="font-size: 0.85rem; margin-bottom: 16px; border-collapse: collapse; width: 100%; max-width: 400px;">
                  <thead>
                    <tr>
                      <th style="padding: 10px 8px; border: 1px solid #ddd; background-color: #f0f0f0; text-align: left; font-weight: 600; font-size: 0.85rem;"></th>
                      <th style="padding: 10px 8px; border: 1px solid #ddd; background-color: #f0f0f0; text-align: left; font-weight: 600; font-size: 0.85rem;">Under 30% limit</th>
                      <th style="padding: 10px 8px; border: 1px solid #ddd; background-color: #f0f0f0; text-align: left; font-weight: 600; font-size: 0.85rem;">Under 50% limit</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td style="padding: 6px 10px; border: 1px solid #ddd;">NSO</td>
                      <td style="padding: 6px 10px; border: 1px solid #ddd;">Sale price</td>
                      <td style="padding: 6px 10px; border: 1px solid #ddd;">Exercise price</td>
                    </tr>
                    <tr>
                      <td style="padding: 6px 10px; border: 1px solid #ddd;">ISO</td>
                      <td style="padding: 6px 10px; border: 1px solid #ddd;">Sale price</td>
                      <td style="padding: 6px 10px; border: 1px solid #ddd;">Strike price</td>
                    </tr>
                  </tbody>
                </table>

                <p style="font-size: 0.85rem; margin-bottom: 12px;">
                  As you can see, you can deduct (significantly) more under the 30% limit, but that may not be worth much if you expect to fully exhaust the limit.
                  NSOs that get switched over are worth more than ISOs, so from a planning perspective, if you go this route, you may 
                  end up donating primarily NSOs in some years, and primarily ISOs in others.
                </p>

                <p style="font-size: 0.85rem; margin-bottom: 12px;">
                  An important thing to know is that if you elect to switch your 30% donations to the 50% limit, you must do it for all your 30% donations that year. The election 
                  applies to all carryover from that year as well, though it doesn't apply to donations initiated in future years. [d] You cannot amend a tax return 
                  to retroactively change this election, in either direction.
                </p>
                
                <p style="font-size: 0.85rem; margin-bottom: 12px;">
                  <span style="display: inline-block; min-width: 20px; font-weight: 500;">[d]</span>
                  The election also applies to carryovers from past years in some way, though I don't know the details. 
                </p>
                
                <h4 style="font-size: 0.95rem; color: #555; margin-top: 24px; margin-bottom: 12px;">Additional notes</h4>
                
                <p style="font-size: 0.85rem; margin-bottom: 8px; font-weight: 500;">Other notes</p>
                <ul style="font-size: 0.85rem; padding-left: 20px; margin-bottom: 16px;">
                  <li>If the charitable deductions would drop you into a significantly lower tax bracket, the calculation of how much you save should be adjusted down (since you're now saving taxes on dollars that are not taxed as heavily). There's no bright line here, but I'd say it starts to come into play if your post-deduction income would be lower than $200-250k per person.</li>
                  <li>The above may also apply if have high income but more than half of it is from long term capital gains, since the deduction will start eating into income taxed at that lower rate.</li>
                  <li>The tax treatment of donations is potentially up for renegotiation this year, especially at the federal level. The last time that happened, the limit for cash donations was changed from 50% to 60% for 2018-2025. I don't see evidence that anything more dramatic than that is being considered, but something to double check in 2026.</li>
                </ul>
                
                <p style="font-size: 0.85rem; margin-bottom: 8px; font-weight: 500;">Special note for California</p>
                <ul style="font-size: 0.85rem; padding-left: 20px; margin-bottom: 16px;">
                  <li>CA reduces itemized deductions in general, including charitable deductions, for high income households. If your household income is ~$250k/person or less, it doesn't affect you. Beyond that, it increases your tax bill by ~$700 for every $100k of income.</li>
                  <li>You can likely cut this penalty in half, if you're married and donating &lt;15% of your household income. It's a bit out of scope for this document, but feel free to DM.</li>
                </ul>
                
                <p style="font-size: 0.85rem; margin-bottom: 8px; font-weight: 500;">Important reminders</p>
                <ul style="font-size: 0.85rem; padding-left: 20px; margin-bottom: 16px;">
                  <li>If you switch tax accountants or tax software, make sure to <span style="font-weight: 600;">copy over your charitable contribution carryovers</span>. Most accountants will not think to ask for it.</li>
                  <li>Do not donate shares that have lost value (i.e. where sale price &lt; exercise price). Sell the shares and donate the cash. See "Cashflow and risk considerations" for further discussion.</li>
                </ul>
              </div>
            </div>
            
            <div class="collapsible-section">
              <h3 style="font-size: 1.1rem; color: #555; margin-bottom: 8px; cursor: pointer; display: flex; align-items: center;" onclick="toggleSection('cashflow-section')">
                <span id="cashflow-toggle" style="margin-right: 8px; font-size: 0.8em; width: 12px;">&#9654;</span>
                Cashflow and risk considerations
              </h3>
              <div id="cashflow-section" style="display: none; margin-top: 16px;">
                <p style="font-size: 0.85rem; margin-bottom: 12px;">
                  From the table above, you can see that exercising in advance of a sale/donation (especially 1+ year in advance) is significantly more favorable 
                  than cashless exercise. So why are we even talking about cashless exercise? 
                </p>
                <p style="font-size: 0.85rem; margin-bottom: 12px;">
                  The two main considerations with exercising in advance are that you have to put up money before you get anything in return (cashflow),
                  and that you risk the loss of the money you put up (what I'm calling risk). Details of the calculation are below.
                </p>

                <p style="font-size: 0.92rem; margin-bottom: 8px; font-weight: 500;">Cashflow</p>
                <ul style="font-size: 0.85rem; padding-left: 20px; margin-bottom: 12px;">              
                  <li>When you exercise NSOs, you owe "strike price + income tax * spread"<span id="nso-exercise-cost"> ($15/share)</span> at the time of exercise. 
                    Some of this you pay in Carta at the time of exercise, and the rest you pay at tax time (appears on your W-2).</li>
                  <li>When you exercise ISOs, you owe "strike price"<span id="iso-exercise-cost"> ($10/share)</span> for sure, and then possibly also owe AMT on the spread. 
                    You do not pay AMT at the time of exercise in Carta; it only appears at tax time (Form 3921).</li>
                </ul>

                <p style="font-size: 0.85rem; margin-bottom: 12px;">
                  The relevance to cashflow is that even if things go well, you won't have access to this money until there is a liquidity event and you sell.
                </p>

                <p style="font-size: 0.92rem; margin-bottom: 8px; font-weight: 500;">Risk</p>
                
                <p style="font-size: 0.85rem; margin-bottom: 12px;">
                  If sale price &gt;= exercise price (i.e. if gain &gt;= 0), then exercising early is always at least as good on net as cashless exercise (so, nothing to worry about).
                  However, if gain < 0, then exercising early will end up coming out worse than cashless exercise.
                </p>

                <p style="font-size: 0.85rem; margin-bottom: 8px; font-weight: 500;">How sales work:</p>
                <ul style="font-size: 0.85rem; padding-left: 20px; margin-bottom: 16px;">
                  <li>In the extreme case, if the sale price is 0, you lose everything you paid at time of exercise, and get a capital loss of "exercise price" that you can carry forward indefinitely, to offset future capital gains.</li>
                  <li>In general, when gain < 0, you did worse than if you had cashless exercised, but are only out money on net if sale price &lt; "what you paid when you exercised" (<span id="payment-when-exercised">$15/share or $10/share + AMT for NSO/ISO respectively</span>). At the time of sale you'll get a free capital loss of "-gain" that you can carry forward indefinitely.</li>
                  <li>One exception is that if you sell an ISO in the same year that you exercise, the AMT is "forgiven", so it'll just be as if you cashless exercised at the time you sold.</li>
                </ul>
                
                <p style="font-size: 0.85rem; margin-bottom: 8px; font-weight: 500;">For donations:</p>
                <ul style="font-size: 0.85rem; padding-left: 20px; margin-bottom: 24px;">
                  <li>If gain < 0, you should sell and donate the money in almost all cases, instead of directly donating the shares. If you do end up donating directly, in the very best case, it's similar to selling and donating the cash, except you don't get the free capital loss. 
                    The worst case is if you donate ISOs that have lost value &lt;1 yr after exercise; they turn into NSOs and I believe you now retroactively owe income tax on the spread.</li>
                </ul>
              </div>
            </div>
            
            <h3 id="footnotes" style="font-size: 1.1rem; color: #555; margin-bottom: 12px;">Footnotes</h3>
            <p style="font-size: 0.85rem; margin-bottom: 12px;">
              <span style="display: inline-block; min-width: 20px; font-weight: 500;">[1]</span>
              I decided to elide differences of a few percent and rare-ish technicalities in favor of simplification. I'm happy to go over any particular (US/California-centric) tax situation if you think 
              there may be a technicality that might apply!
            </p>
            <p style="font-size: 0.85rem; margin-bottom: 8px;">
              <span style="display: inline-block; min-width: 20px; font-weight: 500;">[2]</span>
              The match will likely be in shares, but easier to reason about as the cash-equivalent.
            </p>
            <p style="font-size: 0.85rem; margin-bottom: 8px;">
              <span style="display: inline-block; min-width: 20px; font-weight: 500;">[3]</span>
              Two big caveats: If the total here is large, you may be limited by charity itemized deduction limits (probably deserves its own calculator). If the total here is small, you may need to subtract $5-10k from the total for each year that you donate (mostly to account for when the counterfactual to donating is you getting the standard deduction).
            </p>
            <p style="font-size: 0.85rem; margin-bottom: 8px;">
              <span style="display: inline-block; min-width: 20px; font-weight: 500;">[4]</span>
              This deserves its own calculator, but at a high level, each year you work and have a "normal" tax situation you generate tens of thousands of "AMT credits". Ignoring questions of cash flow, you only end up paying AMT if your (lifetime, post-year-of-exercise) AMT credits don't cover the AMT you owe. 
              For now, I've excluded AMT from Totals, and haven't subtracted it from "what you get in cash".
            </p>
          </div>
        </div>
      </div>
    </div>
    <script src="script.js"></script>
  </body>
</html>